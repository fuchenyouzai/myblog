<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ‚ å“‰çš„åšå®¢</title>

<!-- PWA Manifest -->
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#4CAF50">

<!-- iOS å®‰è£…æ”¯æŒ -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="æ‚ å“‰çš„åšå®¢">
<link rel="apple-touch-icon" href="/icon-192.png">

<style>
/* ===== é¢œè‰²å˜é‡ & ç™½å¤©/å¤œæ™šæ¨¡å¼ ===== */
:root {
  --bg-color: #f4f4f4;
  --text-color: #333;
  --header-bg: #4CAF50;
  --footer-bg: #333;
  --footer-text: #fff;
  --article-bg: #fff;
}
body.dark-mode {
  --bg-color: #1e1e1e;
  --text-color: #f4f4f4;
  --header-bg: #333;
  --footer-bg: #222;
  --footer-text: #f4f4f4;
  --article-bg: #2a2a2a;
}

body {
  background-color: var(--bg-color);
  color: var(--text-color);
  font-family: "Helvetica Neue", Arial, sans-serif;
  margin: 0;
  padding: 0;
}

header {
  background-color: var(--header-bg);
  color: white;
  padding: 20px 10px;
  text-align: center;
}

main {
  max-width: 800px;
  margin: 20px auto;
  padding: 0 10px;
}

article {
  background: var(--article-bg);
  color: var(--text-color);
  margin-bottom: 20px;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

h2 { color: #4CAF50; }
img { max-width:100%; border-radius:5px; }
iframe { width:100%; border:none; border-radius:5px; }
audio { width:100%; margin-top:10px; }

footer {
  text-align:center;
  padding:15px;
  background: var(--footer-bg);
  color: var(--footer-text);
  margin-top:20px;
}

.gallery { display:flex; flex-wrap:wrap; gap:10px; justify-content:center; }
.gallery img { width:30%; border-radius:5px; cursor:pointer; transition:transform 0.3s; }
.gallery img:hover { transform:scale(1.05); }

a.telegram-btn, a.admin-btn {
  display:inline-block;
  padding:10px 15px;
  color:white;
  border-radius:5px;
  text-decoration:none;
  font-weight:bold;
}
a.telegram-btn { background-color:#0088cc; }
a.telegram-btn:hover { background-color:#006699; }
a.admin-btn { background-color:#e53935; }
a.admin-btn:hover { background-color:#b71c1c; }

.video-container, .article-video {
  position: relative;
  width: 100%;
  padding-bottom: 56.25%;
  height: 0;
  overflow: hidden;
  border-radius: 5px;
  margin: 10px 0;
}
.video-container iframe, .article-video iframe, .video-container #live-player {
  position: absolute;
  top:0;
  left:0;
  width:100%;
  height:100%;
  border:none;
}

/* ===== å³ä¸Šè§’ç«–é•¿æ–¹å½¢å®‰è£…æŒ‰é’® ===== */
#install-btn {
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 999;
  width: 120px;
  background-color: #4CAF50;
  color: white;
  border-radius: 12px;
  font-size: 14px;
  font-weight: bold;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 12px 8px;
  line-height: 1.5;
  text-align: center;
  cursor: pointer;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  transition: background-color 0.3s, transform 0.2s;
}
#install-btn:hover { 
  background-color: #388E3C; 
  transform: scale(1.05); 
}

/* ===== å³ä¸‹è§’æ‚¬æµ®æŒ‰é’®ï¼ˆå£°éŸ³ & æ¨¡å¼ï¼‰ ===== */
#sound-toggle-btn, #mode-toggle-btn {
  position: fixed;
  bottom: 20px;
  z-index: 1000;
  padding: 12px 18px;
  border-radius: 6px;
  font-weight: bold;
  cursor: pointer;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  transition: background-color 0.3s, transform 0.2s;
}
#sound-toggle-btn {
  right: 20px;
  background-color: #e53935;
  color: white;
}
#sound-toggle-btn:hover { background-color: #b71c1c; transform: scale(1.05); }

#mode-toggle-btn {
  right: 140px;
  background-color: #555;
  color: white;
  font-size: 14px;
}
#mode-toggle-btn:hover { background-color: #333; transform: scale(1.05); }
</style>
</head>
<body>

<header>
<h1>æ‚ å“‰çš„åšå®¢</h1>
<p>åˆ†äº«æˆ‘çš„ç”Ÿæ´»ä¸å…´è¶£</p>
</header>

<main>
<!-- æ–‡ç« å†…å®¹ -->
<article>
<h2>æˆ‘çš„ç¬¬ä¸€ç¯‡åšæ–‡</h2>
<p>è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢æ–‡ç« ï¼Œæ¬¢è¿å¤§å®¶æ¥åˆ°æˆ‘çš„åšå®¢ï¼æˆ‘ä¼šåˆ†äº«ç”Ÿæ´»ã€æŠ€æœ¯ã€æ—…è¡Œå’Œå„ç§æœ‰è¶£çš„å†…å®¹ã€‚</p>
<img src="https://raw.githubusercontent.com/fuchenyouzai/youzai/main/t2.jpg" alt="ç¤ºä¾‹å›¾ç‰‡">
</article>

<article>
<h2>æ—…è¡Œè§é—»</h2>
<p>ä¸Šå‘¨æˆ‘å»äº†é»„çŸ³å…¬å›­ï¼Œé‚£é‡Œé£æ™¯éå¸¸ç¾ï¼Œæˆ‘æ‹äº†å¾ˆå¤šç…§ç‰‡å’Œè§†é¢‘æƒ³è¦åˆ†äº«ç»™å¤§å®¶ã€‚</p>
<div class="article-video">
  <iframe src="https://www.youtube.com/embed/dQw4w9WgXcQ" title="é»„çŸ³å…¬å›­çŸ­è§†é¢‘" allowfullscreen></iframe>
</div>
<p>éŸ³ä¹åˆ†äº«ï¼š</p>
<audio controls preload="auto" controlsList="nodownload">
  <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾ã€‚
</audio>
</article>

<article>
<h2>è§†é¢‘æ¨è</h2>
<div class="video-container">
  <iframe src="https://www.youtube.com/embed/dQw4w9WgXcQ" title="è§†é¢‘æ¨è" allowfullscreen></iframe>
</div>
</article>

<article>
<h2>å‡¤å‡°å«è§†æœ€æ–°ç›´æ’­</h2>
<div class="video-container">
  <div id="live-player">åŠ è½½ä¸­...</div>
</div>
</article>

<article>
<h2>å›¾ç‰‡å±•ç¤º</h2>
<div class="gallery">
<img src="https://raw.githubusercontent.com/fuchenyouzai/youzai/main/t2.jpg" alt="å›¾ç‰‡1">
<img src="https://via.placeholder.com/300x200?text=å›¾ç‰‡2" alt="å›¾ç‰‡2">
<img src="https://via.placeholder.com/300x200?text=å›¾ç‰‡3" alt="å›¾ç‰‡3">
</div>
</article>

<article>
<h2>æˆ‘çš„ YouTube</h2>
<a href="https://www.youtube.com/@æ‹‚å°˜æ‚ å“‰" target="_blank" class="telegram-btn">è®¿é—® YouTube</a>
<div id="youtube-feed" style="display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:15px; margin-top:10px;"></div>
</article>

<article>
<h2>ç•™è¨€æ¿ï¼ˆGitalkï¼‰</h2>
<div id="gitalk-container"></div>
<a href="https://github.com/fuchenyouzai/youzai/issues" target="_blank" class="admin-btn" style="margin-top:10px;">æŸ¥çœ‹ GitHub åå°è¯„è®º</a>
</article>

<article>
<h2>ç•™è¨€æ¿ï¼ˆDisqus ä¸­æ–‡ï¼‰</h2>
<div id="disqus_thread"></div>
<script>
(function() { 
    var d = document, s = d.createElement('script');
    s.src = 'https://youzaibolg.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
</article>

<article>
<h2>è”ç³»æ–¹å¼</h2>
<a href="https://t.me/fuchenyouzaibot" target="_blank" class="telegram-btn">è”ç³» Telegram</a>
</article>

</main>

<footer>
&copy; 2025 æ‚ å“‰çš„åšå®¢
</footer>

<!-- å®‰è£…æŒ‰é’® -->
<div id="install-btn">
  ç‚¹å‡»å®‰è£…<br>
  æ‚ å“‰åšå®¢<br>
  WebApk<br>
  æ”¯æŒæ‰‹æœº<br>
  æ”¯æŒç”µè„‘<br>
  æ”¯æŒå¹³æ¿
</div>

<!-- å³ä¸‹è§’æŒ‰é’® -->
<button id="sound-toggle-btn">ğŸ”Š æ‰“å¼€å£°éŸ³</button>
<button id="mode-toggle-btn">ğŸŒ™ å¤œæ™šæ¨¡å¼</button>

<!-- Gitalk -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<!-- YouTube IFrame API -->
<script src="https://www.youtube.com/iframe_api"></script>

<script>
document.addEventListener('DOMContentLoaded', () => {
  // Gitalk åˆå§‹åŒ–
  const gitalk = new Gitalk({
    clientID: 'Ov23lijfU0G3M7jiMFAW',
    clientSecret: '47120dd1810d3a2a9aa0033211f5ee73ef29baa3',
    repo: 'youzai',
    owner: 'fuchenyouzai',
    admin: ['fuchenyouzai'],
    id: location.pathname,
    distractionFreeMode: false,
    language: 'zh-CN'
  });
  gitalk.render('gitalk-container');

  // å›¾ç‰‡ç‚¹å‡»æ”¾å¤§
  document.querySelectorAll('.gallery img').forEach(img => {
    img.addEventListener('click', () => {
      const overlay = document.createElement('div');
      overlay.style.position = 'fixed';
      overlay.style.top = 0;
      overlay.style.left = 0;
      overlay.style.width = '100%';
      overlay.style.height = '100%';
      overlay.style.background = 'rgba(0,0,0,0.8)';
      overlay.style.display = 'flex';
      overlay.style.justifyContent = 'center';
      overlay.style.alignItems = 'center';
      overlay.style.cursor = 'pointer';
      overlay.innerHTML = `<img src="${img.src}" style="max-width:90%; max-height:90%; border-radius:5px;">`;
      overlay.addEventListener('click', () => document.body.removeChild(overlay));
      document.body.appendChild(overlay);
    });
  });

  // YouTube è§†é¢‘å¢™
  const videos = [
    {id: "ZB9QSD_SWmM", type: "shorts", title: "æœ€æ–° Shorts è§†é¢‘"},
    {id: "dQw4w9WgXcQ", type: "video", title: "ç¤ºä¾‹è§†é¢‘ 1"},
    {id: "oHg5SJYRHA0", type: "video", title: "ç¤ºä¾‹è§†é¢‘ 2"}
  ];
  const feedContainer = document.getElementById("youtube-feed");
  if (feedContainer) {
    videos.forEach(v => {
      const wrapper = document.createElement("div");
      wrapper.style.display = "flex";
      wrapper.style.flexDirection = "column";
      wrapper.style.gap = "5px";

      const iframeWrapper = document.createElement("div");
      iframeWrapper.style.position = "relative";
      iframeWrapper.style.width = "100%";
      iframeWrapper.style.height = 0;
      iframeWrapper.style.overflow = "hidden";
      iframeWrapper.style.borderRadius = "5px";
      iframeWrapper.style.paddingBottom = v.type === "shorts" ? "177.78%" : "56.25%";
      iframeWrapper.innerHTML = `<iframe src="https://www.youtube.com/embed/${v.id}" 
              style="position:absolute;top:0;left:0;width:100%;height:100%;border:none;"
              title="${v.title}" allowfullscreen></iframe>`;

      const infoDiv = document.createElement("div");
      infoDiv.style.display = "flex";
      infoDiv.style.flexDirection = "column";
      infoDiv.style.alignItems = "center";
      infoDiv.style.gap = "5px";

      const titleEl = document.createElement("p");
      titleEl.textContent = v.title;
      titleEl.style.textAlign = "center";
      titleEl.style.margin = "0";
      titleEl.style.fontWeight = "bold";
      titleEl.style.fontSize = "14px";

      const btn = document.createElement("a");
      btn.href = `https://www.youtube.com/watch?v=${v.id}`;
      btn.target = "_blank";
      btn.textContent = "åœ¨ YouTube ä¸Šè§‚çœ‹";
      btn.style.display = "inline-block";
      btn.style.padding = "5px 10px";
      btn.style.backgroundColor = "#ff0000";
      btn.style.color = "#fff";
      btn.style.borderRadius = "4px";
      btn.style.fontSize = "12px";
      btn.style.textDecoration = "none";

      infoDiv.appendChild(titleEl);
      infoDiv.appendChild(btn);
      wrapper.appendChild(iframeWrapper);
      wrapper.appendChild(infoDiv);
      feedContainer.appendChild(wrapper);
    });
  }

  // ===== PWA Service Worker æ³¨å†Œ =====
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js')
      .then(registration => console.log('Service Worker æ³¨å†ŒæˆåŠŸ:', registration.scope))
      .catch(err => console.log('Service Worker æ³¨å†Œå¤±è´¥:', err));
  }

  // ===== å®‰è£…æŒ‰é’®é€»è¾‘ =====
  const installBtn = document.getElementById('install-btn');
  let deferredPrompt;
  const isEdge = /Edg/i.test(navigator.userAgent);
  const isChrome = /Chrome/i.test(navigator.userAgent) && !isEdge;

  if (isChrome) {
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
    });
  }

  installBtn.addEventListener('click', async () => {
    if (isChrome) {
      if (!deferredPrompt) { alert("PWA å®‰è£…æ¡ä»¶æœªæ»¡è¶³ï¼Œæˆ–å·²å®‰è£…"); return; }
      deferredPrompt.prompt();
      await deferredPrompt.userChoice;
      deferredPrompt = null;
    } else if (isEdge) {
      alert("è¯·é€šè¿‡æµè§ˆå™¨èœå•ï¼ˆå³ä¸Šè§’ â‹®ï¼‰é€‰æ‹©â€œæ·»åŠ åˆ°æ¡Œé¢â€æ¥å®‰è£…åˆ°æ‰‹æœºæˆ–ç”µè„‘æ¡Œé¢ã€‚");
    } else {
      alert("å½“å‰æµè§ˆå™¨ä¸æ”¯æŒè‡ªåŠ¨å®‰è£…ï¼Œè¯·ä½¿ç”¨ Chrome æˆ– Edge æµè§ˆå™¨ã€‚");
    }
  });

}); // ===== DOMContentLoaded ç»“æŸ =====

// ===== YouTube Player API åˆå§‹åŒ–ï¼ˆå‡¤å‡°å«è§†æœ€æ–°ç›´æ’­ï¼‰ =====
let livePlayer;
let soundOn = false;

function onYouTubeIframeAPIReady() {
  // è‡ªåŠ¨è·å–æœ€æ–°ç›´æ’­ IDï¼Œè¿™é‡Œå¯æ›¿æ¢ä¸ºçœŸå® API
  const latestLiveID = 'fN9uYWCjQaw';
  livePlayer = new YT.Player('live-player', {
    videoId: latestLiveID,
    playerVars: { autoplay: 1, mute: 1, controls: 1, modestbranding: 1 },
    events: { 'onReady': (event) => { event.target.mute(); } }
  });
}

// ===== å³ä¸‹è§’å£°éŸ³å¼€å…³æŒ‰é’®é€»è¾‘ =====
const soundBtn = document.getElementById('sound-toggle-btn');
soundBtn.addEventListener('click', () => {
  if (!livePlayer) return;
  if (soundOn) {
    livePlayer.mute();
    soundBtn.textContent = 'ğŸ”Š æ‰“å¼€å£°éŸ³';
    soundOn = false;
  } else {
    livePlayer.unMute();
    soundBtn.textContent = 'ğŸ”‡ å…³é—­å£°éŸ³';
    soundOn = true;
  }
});

// ===== ç™½å¤©/å¤œæ™šæ¨¡å¼åˆ‡æ¢é€»è¾‘ =====
const modeBtn = document.getElementById('mode-toggle-btn');
modeBtn.addEventListener('click', () => {
  document.body.classList.toggle('dark-mode');
  if (document.body.classList.contains('dark-mode')) {
    modeBtn.textContent = "â˜€ï¸ ç™½å¤©æ¨¡å¼";
  } else {
    modeBtn.textContent = "ğŸŒ™ å¤œæ™šæ¨¡å¼";
  }
});
</script>

</body>
</html>